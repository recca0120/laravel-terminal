{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["do ($ = jQuery, window, document) ->\r\n    csrfToken = $ \"meta[name='csrf-token']\"\r\n        .attr \"content\"\r\n\r\n    $.ajaxSetup\r\n        headers:\r\n            'X-CSRF-TOKEN': csrfToken\r\n\r\n    shouldSkipCommands = [\"artisan tinker\", \"mysql\", \"tinker\"]\r\n    executableCommands = [\"mysql\"]\r\n    $.each Terminal.endPoints, (key, url) ->\r\n        if $.inArray(key, shouldSkipCommands) is -1\r\n            executableCommands.push key\r\n    executableCommands.sort()\r\n\r\n    showAvailableCommands = ->\r\n        temp = [\"help\", \"clear\"].concat executableCommands\r\n        temp.sort()\r\n        availableCommands = []\r\n        $.each temp, (i, command) ->\r\n            availableCommands.push info(command)\r\n        \"#{comment('Available commands:')} #{availableCommands.join(\", \")}\"\r\n\r\n    outputFormater = (str, color) ->\r\n        str = str\r\n            .replace /&/g, \"&amp;\"\r\n            .replace /\\[/g, \"&#91;\"\r\n            .replace /\\]/g, \"&#93;\"\r\n        \"[[;#{color};]#{str}]\"\r\n\r\n    info = (str) ->\r\n        outputFormater str, \"#008400\"\r\n\r\n    comment = (str) ->\r\n        outputFormater str, \"#a50\"\r\n\r\n    Loading = do ->\r\n        anim = [\"/\", \"|\", \"\\\\\", \"-\"]\r\n        intervalId = null\r\n        delay = 50\r\n        defaultPrompt = null\r\n        show: (term) ->\r\n            term.disable()\r\n            defaultPrompt = term.get_prompt()\r\n            i = 0\r\n            intervalId = setInterval ->\r\n                term.set_prompt anim[i++]\r\n                if i > anim.length-1\r\n                    i = 0\r\n            , delay\r\n        hide: (term) ->\r\n            clearInterval intervalId\r\n            term.enable()\r\n            term.set_prompt defaultPrompt\r\n\r\n\r\n    greetings =\r\n        copyright: [\r\n            \" __                        _    _____              _         _ \"\r\n            \"|  |   ___ ___ ___ _ _ ___| |  |_   ____ ___ _____|_|___ ___| |\"\r\n            \"|  |__| .'|  _| .'| | | -_| |    | || -_|  _|     | |   | .'| |\"\r\n            \"|_____|__,|_| |__,|\\\\_/|___|_|    |_||___|_| |_|_|_|_|_|_|__,|_|\"\r\n            \"\"\r\n            \"Copyright (c) 2015 Recca Tsai <http://phpwrite.blogspot.tw/>\"\r\n            \"\"\r\n            \"\"\r\n            \"\"\r\n            \"Type a command, or type `#{info('help')}`, for a list of commands.\"\r\n            \"\"\r\n            \"#{showAvailableCommands()}\"\r\n            \"\"\r\n        ].join \"\\n\"\r\n\r\n        production: [\r\n            \"\"\r\n            comment(\"**************************************\")\r\n            comment(\"*     Application In Production!     *\")\r\n            comment(\"**************************************\")\r\n            \"\"\r\n        ].join \"\\n\"\r\n\r\n    request = do ->\r\n        ids = {}\r\n        (url, term, method, params) ->\r\n            ids[url] = ids[url] || 0;\r\n            # term.pause()\r\n            Loading.show term\r\n            $.ajax\r\n                url: url,\r\n                dataType: 'json'\r\n                type: 'post'\r\n                data:\r\n                    jsonrpc: \"2.0\"\r\n                    method: method\r\n                    params: params\r\n                    id: ++ids[url]\r\n            .success (response) ->\r\n                if response.result is false\r\n                    term.error response.error\r\n                else\r\n                    term.echo response.result\r\n            .error (xhr, type, message) ->\r\n                term.error message\r\n            .complete ->\r\n                Loading.hide term\r\n                # term.resume()\r\n\r\n    terminalConfirm = do ->\r\n        parseBoolean = (result) ->\r\n            return switch (result.toLowerCase())\r\n                when 'y', 'yes' then true\r\n                else false\r\n\r\n        (term, message = \"\", prompt = \">\") ->\r\n            defer = $.Deferred()\r\n\r\n            if message isnt \"\"\r\n                term.echo message\r\n\r\n            term.echo \"#{prompt}\"\r\n            term.push (command) ->\r\n                defer.resolve parseBoolean(command)\r\n                term.pop()\r\n                return\r\n            ,\r\n                prompt: \">\"\r\n\r\n            defer.promise()\r\n\r\n    starts_with = (str, search) ->\r\n        return str.indexOf(search) is 0\r\n\r\n    interpreter = (command, term, callback =(() ->), prompt) ->\r\n        unless prompt\r\n            prompt = command\r\n\r\n        term.push (command) ->\r\n            callback(prompt, command, term)\r\n            return false\r\n        ,\r\n            prompt: \"#{prompt}>\"\r\n        return false\r\n\r\n    execute = (cmd, term) ->\r\n        endPoint = Terminal.endPoints[cmd.name]\r\n        params = cmd.args\r\n        method = params.shift() or []\r\n\r\n        if (cmd.name is \"artisan\" and Terminal.environment is \"production\" and $.inArray(\"--force\", params) is -1) and (\r\n            (starts_with(method, \"migrate\") is true and starts_with(method, \"migrate:status\") is false) or\r\n            starts_with(method, \"db:seed\") is true\r\n        )\r\n            terminalConfirm term, \"#{greetings.production}\", \"#{info('Do you really wish to run this command? [y/N] (yes/no)')} &#91;#{comment('no')}&#93;: \"\r\n                .done (result) ->\r\n                    if result is true\r\n                        params.push \"--force\"\r\n                        request endPoint, term, method, params\r\n                    else\r\n                        term.echo \"\\n#{comment('Command Cancelled!')}\\n\"\r\n            return\r\n        else\r\n            request endPoint, term, method, params\r\n        return\r\n\r\n    $(document.body).terminal (command, term) ->\r\n        switch command\r\n            when \"help\"\r\n                term.echo \" \"\r\n                term.echo showAvailableCommands()\r\n                term.echo \" \"\r\n                return\r\n            when \"test\"\r\n                window.term = term\r\n                return\r\n            when \"\"\r\n                return\r\n            when \"mysql\"\r\n                interpreter command, term, (prompt, command, term) ->\r\n                    endPoint = Terminal.endPoints[prompt]\r\n                    request endPoint, term, command, []\r\n                return\r\n            when \"artisan tinker\"\r\n                interpreter command, term, (prompt, command, term) ->\r\n                    endPoint = Terminal.endPoints[prompt]\r\n                    request endPoint, term, command, []\r\n                , \"tinker\"\r\n                return\r\n            else\r\n                cmd = $.terminal.parseCommand command.trim()\r\n                if $.inArray(cmd.name, executableCommands) isnt -1\r\n                    execute cmd, term\r\n                    return\r\n                else\r\n                    term.error \"Command '#{command}' Not Found!\"\r\n                    return\r\n    ,\r\n        greetings: greetings.copyright\r\n        onBlur: ->\r\n            false\r\n"],"sourceRoot":"/source/"}